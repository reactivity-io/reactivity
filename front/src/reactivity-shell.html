<!--Import polymer element once at the main element -->
<link rel="import" href="../bower_components/polymer/polymer-element.html">
<link rel="import" href="../bower_components/app-router/app-router.html">
<link rel="import" href="./components/color-konami.html">
<link rel="import" href="shell/navbar/navbar.html">

<dom-module id="s-reactivity">
    <script src="./mixins/provider.mixin.js"></script>
    <script src="./mixins/mixinBuilder.js"></script>
    <script src="./mixins/const.mixin.js"></script>
    <script src="./mixins/http.mixin.js"></script>
    <template>
        <custom-style>
            <style>
                body {
                    margin: 0;
                    font-family: 'Roboto', 'Noto', sans-serif;
                    background-color: var(--app-greyscale-1);
                }

                :host {
                    margin: 0;
                    display: block;
                    height: 100vh;
                    font-family: 'Roboto', 'Noto', sans-serif;

                    --app-primary-color: #E8345A;
                    --app-primary-dark: #961632;
                    --app-primary-ligth: #E86F89;

                    --app-greyscale-1: #2b2b2b;
                    --app-greyscale-2: #313335;
                    --app-greyscale-3: #3C3E3F;
                    --app-greyscale-4: #3c3f41;
                    --app-greyscale-5: #515658;
                    --app-greyscale-6: #65686A;
                    --app-greyscale-7: #FFFFFF;

                    --topbar-height: 65px;

                    --card-width: 455px;
                    --card-img-heigth: 218px;
                    --card-footer-heigth: 56px;

                }

                #router {
                    top: var(--topbar-height);
                    position: relative;
                }
            </style>
        </custom-style>

        <my-provider></my-provider>
        <s-navbar></s-navbar>
        <app-router id="router" class="flex" mode="pushstate">
            <app-route path="/" import="./src/shell/pages/organisations/organisations.html"
                       element="s-organisations"></app-route>
            <app-route path="/settings" import="./src/shell/pages/settings/settings.html"
                       element="s-settings"></app-route>
            <app-route path="/organisation/:id" import="./src/shell/pages/organisation/organisation.html"
                       element="s-organisation"></app-route>
            <app-route path="/view/:id" import="./src/shell/pages/view/view.html" element="s-view"></app-route>
            <app-route path="*" import="./src/shell/pages/404/view-404.html"></app-route>
        </app-router>
        <color-konami id="konami"/>
    </template>
    <script>
        // Extend Polymer.Element base class
        class ReactivityShell extends Polymer.Element {
            static get is() {
                return 's-reactivity';
            }

            connectedCallback() {
                super.connectedCallback();
                console.log('%cWelcome to Reactivity!\n%cweb components are the <bees-knees>', "font-size:1.5em;color:#4558c9;", "color:#d61a7f;font-size:1em;")

                this.$.konami.init(this);
                //The application (My-app element) manage the routing so let him switch page :)

                document.addEventListener('nav', (e) => {
                    this.$.router.go(e.detail.path);
                });

                document.addEventListener('error', () => {
                    this.$.router.go('/404');
                });

                //No need to removeListener cause this is the main entry point of the application (if unmount no more fun)
            }
        }
        // Register custom element definition using standard platform API
        customElements.define(ReactivityShell.is, ReactivityShell);
    </script>

</dom-module>
